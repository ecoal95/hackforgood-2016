<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Simple Polylines</title>
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 500px;
        width: 500px;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>

      function initMap(distance) {
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 3,
          center: {lat: 0, lng: -180},
          mapTypeId: google.maps.MapTypeId.TERRAIN
        });

// Fuente para crear rutas: http://itouchmap.com/latlong.html
var total_route = [
    {lat: 40.437401, lng: -3.724365}, // Primer punto madrid
    {lat: 48.862667, lng: 2.362061}, // Segundo punto París
    {lat: 52.500953, lng: 13.40332}, // Tercer punto Berlín
    {lat: 55.799531, lng: 37.63916}, // Cuarto punto Moscú
    {lat: 40.592543, lng: -74.003906} // Quinto punto Nueva York
];

var flightPlanCoordinates;
for (var i = 1; i < total_route.length; ++i) {
    distance -= getDist(total_route[0].lat, total_route[0].lon, total_route[1].lan, total_route[1].lon);
}
/*
        var flightPlanCoordinates = [
          {lat: 37.772, lng: -122.214},
          {lat: 21.291, lng: -157.821},
          {lat: -18.142, lng: 178.431},
          {lat: -27.467, lng: 153.027}
        ];
*/

// Rellenar array flightPath



        var flightPath = new google.maps.Polyline({
          path: flightPlanCoordinates,
          geodesic: true,
          strokeColor: '#FF0000',
          strokeOpacity: 1.0,
          strokeWeight: 2
        });

        flightPath.setMap(map);

      }

    // Función que dadas 2 coordenadas devuelve la distancia en Km
    // Fuente: http://www.movable-type.co.uk/scripts/latlong.html
    function getDist(lat1, lon1, lat2, lon2) {

        var R = 6371000;
        var latRad1 = lat1.toRadians();
        var latRad2 = lat2.toRadians();
        var difLat = (lat2-lat1).toRadians();
        var difLon = (lon2-lon1).toRadians();

        var a = Math.sin(difLat/2)*Math.sin(difLat/2) +
                Math.cos(latRad1)*Math.cos(latRad2)*
                Math.sin(difLon/2)*Math.sin(difLon/2);

        var c = 2*Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

        return R*c;
        
    }

    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCgKm-05WMBnNa072X1d9qBVUy1igH17b0&signed_in=true&callback=initMap">
    </script>
    <a href="javascript:drawPolyline(5000); return false;">Test</a>
  </body>
</html>
